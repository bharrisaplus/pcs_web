# yaml-language-server: $schema=https://taskfile.dev/schema.json

# Tasks are expected to be called from the project root or via the main Taskfile

version: '3'

tasks:
  # Building/Transpiling/etc
  rear-presentation:
    desc: Stlus to CSS
    cmds:
      - pnpm stylus {{.PRESENTATION_DIR}}/demo.styl -m --sourcemap-base {{.DEMO_FILE_HOST}} -o {{.DEMO_DIR}}/main.css
      - pnpm postcss {{.DEMO_DIR}}/main.css --config {{.PROJECT_DIR}} -o {{.DEMO_DIR}}/main.css
  rear-content:
    desc: Pug to HTML
    cmds:
      - pnpm pug {{.CONTENT_DIR}}/demo.pug -o {{.DEMO_DIR}}
  rear-behavior:
    desc: JS
    cmds:
      -  pnpm rollup -c {{.PROJECT_DIR}}/rollup.config.mjs
  nit-behavior:
    desc: Keeping js/mjs consistent
    cmds:
      - pnpm eslint -c {{.PROJECT_DIR}}/eslint.config.mjs {{.BEHAVIOR_DIR}}/demo.js
  nit-presentation:
    desc: Keeping stylus/css consistent
    cmds:
      - pnpm stylelint -c {{.PROJECT_DIR}}/stylelint.config.mjs {{.PRESENTATION_DIR}}/demo.styl
  # Moving things around
  put-vendor:
    desc: Copy 3rd party scripts/stylesheets/etc
    cmds:
      - cp {{.COMMON_DIR}}/vendor/meyerweb/reset.css {{.DEMO_DIR}}
      - cp {{.COMMON_DIR}}/vendor/html2canvas/html2canvas.{js,js.map} {{.DEMO_DIR}}
      - cp {{.COMMON_DIR}}/vendor/chancejs/chance.js {{.DEMO_DIR}}
      - echo "MeyerWeb-CSSReset, HTML2Canvas and ChanceJS placed with demo files"
  # Clean up/Tear down
  sweep-content:
    desc: Remove generated files
    cmds:
      - rm -f {{.DEMO_DIR}}/demo.html
  sweep-presentation:
    desc: Remove generated files
    cmds:
      - rm -f {{.DEMO_DIR}}/main.{css,css.map}
      - rm -f {{.DEMO_DIR}}/reset.css
  sweep-behavior:
    desc: Remove generated files
    cmds:
      - rm -f {{.DEMO_DIR}}/main.{js,js.map,mjs}
      - rm -f {{.DEMO_DIR}}/html2canvas.{js,js.map}
      - rm -f {{.DEMO_DIR}}/chance.{js,min.js,min.js.map}
