!function(){"use strict";var e,t,a,o;e=window,t=document,a=html2canvas,o=chance,e.onload=()=>{const l=t.querySelector(".closeup .dust-cover"),d=l.querySelector(".turntable"),s=d.querySelector(".turntable-pickup"),n=d.querySelector(".turn-off"),r=d.querySelector(".turntable-cue-lever-regression"),c=d.querySelector(".turntable-cue-lever-progression"),i=t.querySelector(".ribbon .export"),u=t.querySelector(".ribbon .shuffle"),b=t.querySelector('.ribbon [name="bg-wells"]'),p=[],y=["spade","diamond","club","heart"],m=s.className,h=Array.from(t.querySelector(".closeup").classList).slice(0,-1);let v=[];const f=e=>y[Math.floor(e/13)],g=e=>{"open"===e.oldState&&"closed"===e.newState?(s.textContent="",s.className=m,c.disabled=!1,r.disabled=!1,i.disabled=!1,u.disabled=!1,b.disabled=!1):"closed"===e.oldState&&"open"===e.newState&&(i.disabled=!0,u.disabled=!0,b.disabled=!0)},S=()=>{u.disabled=!0,i.disabled=!0,b.disabled=!0;const a=o.shuffle(Array.from(t.querySelectorAll(".closeup .pad li")));v=a.map(e=>e.textContent),t.querySelector(".closeup .pad").replaceChildren(...a),i.disabled=!1,b.disabled=!1,e.setTimeout(()=>{l.matches(":popover-open")||(u.disabled=!1)},5e3)},x=(e,t)=>{const a=e.target;if(a){const e=`${0==t?"":"-"}${t}deg`;a.style.rotate!=e&&(a.style.rotate=e)}},q=e=>{if(!l.matches(":popover-open")){const t=e.target;if(t&&t.textContent!=s.textContent){const e=p.indexOf(t.textContent);e>-1&&(s.textContent=t.textContent,s.className=`${m} ${f(e)} playing-card`,0==e?r.disabled=!0:51==e&&(c.disabled=!0),l.showPopover())}}},w=e=>{const t=v.indexOf(s.textContent),a=e.target===r;let o;if(o=a?Math.max(0,t-1):Math.min(51,t+1),o!=t){const e=v[o],t=f(p.indexOf(e));s.textContent=e,s.className=`${m} ${t} playing-card`,0==o?r.disabled=!0:51==o&&(c.disabled=!0),a?c.disabled=!1:r.disabled=!1}};Object.hasOwn(HTMLElement.prototype,"popover")&&(t.querySelectorAll(".closeup .pad li").forEach(e=>{p.push(e.textContent),e.addEventListener("mouseenter",e=>x(e,9)),e.addEventListener("mouseleave",e=>x(e,0)),e.addEventListener("click",q)}),v=Array.from(p),l.addEventListener("beforetoggle",g),n.addEventListener("click",()=>l.hidePopover()),r.addEventListener("click",w),c.addEventListener("click",w),i.addEventListener("click",o=>{(async(o,d,s)=>{const n=t.querySelector(d),r=t.querySelector(s);let c,p;i.disabled=!0,u.disabled=!0,b.disabled=!0,c=await a(n,{height:n.scrollHeight,width:n.getBoundingClientRect().width}),p=c.toDataURL("image/png"),r.href=p,r.download="pcs_demo_ndo.png",r.textContent="redownload here",r.click(),u.disabled=!1,b.disabled=!1,e.setTimeout(()=>{r.href="",r.download="",r.textContent="",l.matches(":popover-open")||(i.disabled=!1)},5e3)})(0,".closeup",".ribbon .export-zone")}),u.addEventListener("click",S),b.value="0",b.addEventListener("change",e=>{const a=e.target?.value||0,o=t.querySelector(".closeup");switch(a){case"1":o.className=`${h} green-dye`;break;case"2":o.className=`${h} red-dye`;break;case"3":o.className=`${h} blue-dye`;break;case"4":o.className=`${h} purple-dye`}}))}}();
